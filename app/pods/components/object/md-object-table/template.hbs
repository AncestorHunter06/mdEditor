<div class="md-object-table panel panel-default box-shadow--8dp {{if editing "editing"}}">

    <div class="panel-heading">
        <h3 class="panel-title md-panel-chevron">
            <a role="button" data-toggle="collapse" href="#{{unless editing panelId}}" aria-expanded="{{if collapsed "false" "true"}}"
               class="{{if collapsed "collapsed"}}" aria-controls="{{panelId}}">
                <span class="fa"></span> {{header}}
                <label class="label label-pill {{pillColor}}"> {{items.length}} </label>
            </a>
            <button type="button" id="{{panelId}}-btn" class="btn btn-xs btn-info pull-right {{if editing "hidden"}}"
                {{action "addItem" items}}>
                {{fa-icon "plus"}} Add
            </button>
            <button type="button" class="btn btn-xs btn-info pull-right {{unless editing "hidden"}}" {{action 'cancelEdit'}}>
                <span class="fa fa-check"></span> OK
            </button>
        </h3>
    </div>

    <div id="{{panelId}}" class="panel-collapse {{if collapsed "collapse" "in"}}">
        <div class="panel-body">
            <table class="table table-striped table-hover fadeIn {{if ellipsis "ellipsis"}}">
                {{#unless previewTemplate}}

                <thead>
                  <th>#</th>
                  {{#each attrTitleArray as |prop|}}
                  <th>{{uc-words prop}}</th>
                  {{/each}}
                  <th></th>
                </thead>
                {{/unless}}
                <tbody>
                {{#each items as |item index|}}
                    <tr>
                        <td class="md-table-index">
                          {{index}}
                        </td>
                        {{#if previewTemplate}}
                            <td class="property">{{component previewTemplate item=item}}</td>
                        {{else}}
                            {{#each attrArray as |prop|}}
                                {{#if (get item prop)}}
                                <td class="property"><div class="wrap">{{get item prop}}</div></td>
                                {{else}}
                                <td><em>Not Defined</em></td>
                                {{/if}}
                            {{/each}}
                        {{/if}}
                        <td>
                            {{#if item.validations.isInvalid}}
                            <span class="md-error pull-right">
                              {{fa-icon "exclamation-circle" fixedWidth=true}}
                              {{#tooltip-on-element side="right" class="md-tooltip danger"}}
                              This item has errors.
                              {{/tooltip-on-element}}
                            </span>
                            {{else}}
                            <span class="md-error pull-right">
                                <span class="fa fa-fw"></span>
                            </span>
                            {{/if}}
                            <button class="btn btn-xs btn-danger pull-right" {{action "deleteItem" items index}}>
                                <span class="fa fa-times"></span> Delete
                            </button>
                            <span class="pull-right">&nbsp;</span>
                            <button class="btn btn-xs btn-success pull-right" {{action "editItem" items index}}>
                                {{fa-icon "pencil"}} Edit
                            </button>
                        </td>
                    </tr>
                {{else}}
                <tr>
                    <td colspan="{{add-em attrArray.length 2}}">
                      <button type="button" id="{{panelId}}-btn" class="btn btn-xs btn-info"
                          {{action "addItem" items}}>
                          {{fa-icon "plus"}} {{buttonText}}
                      </button>
                    </td>
                </tr>
                {{/each}}
                </tbody>
            </table>
            <div class="object-editor fadeOut">
                {{#if editing}}
                    {{yield saveItem}}
                {{/if}}
                <hr>
                <button type="button" class="btn btn-xs btn-info" {{action "cancelEdit"}}>
                    <span class="fa fa-check"></span> OK
                </button>
            </div>
        </div>
    </div>

</div>
