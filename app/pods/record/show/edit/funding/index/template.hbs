<h4 class="section-header">
  Editing Funding
  {{control/md-status model=parentModel}}
</h4>
{{#unless model.json.metadata.funding}}
  <h3 class="alert alert-info">No funding allocations found.
    <button type="button" class="btn btn-success" {{action "addAllocation"}}>
      {{fa-icon "plus"}} Add Funding Allocation</button>
  </h3>
{{/unless}}

{{#each model.json.metadata.funding as |allocation index|}}
  {{#layout/md-card
    title=(concat "Allocation #" index)
    collapsible=true
    collapsed=false
    profilePath="funding.allocation"
    data-spy=(concat "Allocation " index)
    shadow=true
    spotlightEnabled=false
    flex=true
  }}
      <div class="flex-grow">
        {{object/md-funding/preview item=allocation}}
      </div>
      <div class="btn-group-vertical" role="group" aria-label="CRUD buttons">
        <button type="button" class="btn btn-md btn-success btn-block md-btn-responsive" {{action "editAllocation" index}}>
          {{fa-icon "pencil"}} Edit Allocation</button>
        {{#control/md-button-confirm class="btn btn-md btn-danger btn-block md-btn-responsive"
          onConfirm=(route-action "deleteAllocation" index)}}
          {{fa-icon "times"}} Delete Allocation
        {{/control/md-button-confirm}}
      </div>
  {{/layout/md-card}}

{{/each}}

{{to-elsewhere
  named="md-subbar-extra"
  send=(component "control/subbar-link"
  clickText="Add Funding Allocation"
  clickIcon="plus"
  clickType="success"
  click=(route-action "addAllocation")
  )
}}

{{to-elsewhere named="md-scroll-spy-record-edit"
  send=(component "control/md-scroll-spy"  scrollInit=scrollTo setScrollTo=(route-action "setScrollTo"))}}
